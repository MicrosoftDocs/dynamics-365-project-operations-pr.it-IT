---
title: Integrazione di gestione spese
description: Questo argomento fornisce informazioni sull'integrazione delle note spese in Project Operations usando la doppia scrittura.
author: sigitac
ms.date: 04/28/2021
ms.topic: article
ms.prod: ''
ms.reviewer: kfend
ms.author: sigitac
ms.openlocfilehash: 7fff69f062bf09fe7ceca61d951b535d2e010bfd
ms.sourcegitcommit: 40f68387f594180af64a5e5c748b6efa188bd300
ms.translationtype: HT
ms.contentlocale: it-IT
ms.lasthandoff: 05/10/2021
ms.locfileid: "5999991"
---
# <a name="expense-management-integration"></a><span data-ttu-id="b480d-103">Integrazione di gestione spese</span><span class="sxs-lookup"><span data-stu-id="b480d-103">Expense management integration</span></span>

<span data-ttu-id="b480d-104">_**Si applica a:** Project Operations per scenari basati su risorse/materiali non stoccati_</span><span class="sxs-lookup"><span data-stu-id="b480d-104">_**Applies To:** Project Operations for resource/non-stocked based scenarios_</span></span>

<span data-ttu-id="b480d-105">Questo argomento fornisce informazioni sull'integrazione delle note spese nella [distribuzione completa delle spese](../expense/expense-overview.md) di Project Operations usando la doppia scrittura.</span><span class="sxs-lookup"><span data-stu-id="b480d-105">This topic provides information about expense reports integration in Project Operations [full expense deployment](../expense/expense-overview.md) using dual-write.</span></span>

## <a name="expense-categories"></a><span data-ttu-id="b480d-106">Categorie di spesa</span><span class="sxs-lookup"><span data-stu-id="b480d-106">Expense categories</span></span>

<span data-ttu-id="b480d-107">In una distribuzione completa delle spese, le categorie di spesa vengono create e gestite nelle app Finance and Operations.</span><span class="sxs-lookup"><span data-stu-id="b480d-107">In a full expense deployment, expense categories are created and maintained in Finance and Operations apps.</span></span> <span data-ttu-id="b480d-108">Per creare una nuova categoria di spesa, completa i seguenti passaggi:</span><span class="sxs-lookup"><span data-stu-id="b480d-108">To create a new expense category, complete the following steps:</span></span>

1. <span data-ttu-id="b480d-109">In Microsoft Dataverse, crea una categoria **Transazione**.</span><span class="sxs-lookup"><span data-stu-id="b480d-109">In Microsoft Dataverse, create a **Transaction** category.</span></span> <span data-ttu-id="b480d-110">L'integrazione a doppia scrittura sincronizzerà questa categoria di transazione con le app Finance and Operations.</span><span class="sxs-lookup"><span data-stu-id="b480d-110">Dual-write integration will synchronize this transaction category to Finance and Operations apps.</span></span> <span data-ttu-id="b480d-111">Per ulteriori informazioni, vedi [Configurare le categorie di progetto](/dynamics365/project-operations/project-accounting/configure-project-categories) e [Installazione di Project Operations e integrazione dei dati di configurazione](resource-dual-write-setup-integration.md).</span><span class="sxs-lookup"><span data-stu-id="b480d-111">For more information, see [Configure project categories](/dynamics365/project-operations/project-accounting/configure-project-categories) and [Project Operations setup and configuration data integration](resource-dual-write-setup-integration.md).</span></span> <span data-ttu-id="b480d-112">Come risultato di questa integrazione, il sistema crea quattro record di categoria condivisi nelle app Finance and Operations.</span><span class="sxs-lookup"><span data-stu-id="b480d-112">As a result of this integration, the system creates four shared category records in Finance and Operations apps.</span></span>
2. <span data-ttu-id="b480d-113">In Finance, vai in **Gestione spese** > **Configura** > **Categorie condivise** e seleziona una categoria condivisa con una classe di transazione **Spese**.</span><span class="sxs-lookup"><span data-stu-id="b480d-113">In Finance, go to **Expense management** > **Setup** > **Shared categories** and select a shared category with an **Expense** transaction class.</span></span> <span data-ttu-id="b480d-114">Imposta il parametro **Può essere utilizzato in Spese** su **Vero** e definisci il tipo di spesa da utilizzare.</span><span class="sxs-lookup"><span data-stu-id="b480d-114">Set the **Can be used in Expense** parameter to **True** and define the expense type to use.</span></span>
3. <span data-ttu-id="b480d-115">Utilizzando questo record di categoria condivisa, crea una nuova categoria di spesa andando in **Gestione spese** > **Configura** > **Categorie di spesa** e selezionando **Nuovo**.</span><span class="sxs-lookup"><span data-stu-id="b480d-115">Using this shared category record, create a new expense category by going to **Expense management** > **Setup** > **Expense categories** and selecting **New**.</span></span> <span data-ttu-id="b480d-116">Quando il record viene salvato, la doppia scrittura utilizza la mappa della tabella **Entità di esportazione categorie di spesa di progetto integrazione di Project Operations (msdyn\_expensecategories)** per sincronizzare questo record in Dataverse.</span><span class="sxs-lookup"><span data-stu-id="b480d-116">When the record is saved, dual-write uses the table map, **Project Operations integration project expense categories export entity (msdyn\_expensecategories)** to synchronize this record to Dataverse.</span></span>

  ![Integrazione di categorie di spesa](./media/DW6ExpenseCategories.png)

<span data-ttu-id="b480d-118">Le categorie di spesa nelle app Finance and Operations sono specifiche dell'azienda o della persona giuridica.</span><span class="sxs-lookup"><span data-stu-id="b480d-118">Expense categories in Finance and Operations apps are company- or legal entity-specific.</span></span> <span data-ttu-id="b480d-119">Esistono record corrispondenti specifici della persona giuridica separati in Dataverse.</span><span class="sxs-lookup"><span data-stu-id="b480d-119">There are separate, corresponding legal entity-specific records in Dataverse.</span></span> <span data-ttu-id="b480d-120">Quando un responsabile di progetto stima le spese, non può selezionare le categorie di spesa create per un progetto di proprietà di una società diversa da quella a cui appartiene il progetto su cui stanno lavorando.</span><span class="sxs-lookup"><span data-stu-id="b480d-120">When a project manager estimates expenses, they can’t select expense categories that were created for a project that is owned by a different company than the company that owns the project they are working on.</span></span> 

## <a name="expense-reports"></a><span data-ttu-id="b480d-121">Note spese</span><span class="sxs-lookup"><span data-stu-id="b480d-121">Expense reports</span></span>

<span data-ttu-id="b480d-122">Le note spese vengono create e approvate nelle app Finance and Operations.</span><span class="sxs-lookup"><span data-stu-id="b480d-122">Expense reports are created and approved in Finance and Operations apps.</span></span> <span data-ttu-id="b480d-123">Per ulteriori informazioni, vedi [Creare ed elaborare le note spese in Dynamics 365 Project Operations](/learn/modules/create-process-expense-reports/).</span><span class="sxs-lookup"><span data-stu-id="b480d-123">For more information, see [Create and process expense reports in Dynamics 365 Project Operations](/learn/modules/create-process-expense-reports/).</span></span> <span data-ttu-id="b480d-124">Dopo che la nota spese è stata approvata dal responsabile di progetto, viene registrata nella contabilità generale.</span><span class="sxs-lookup"><span data-stu-id="b480d-124">After the expense report is approved by the Project manager, it's posted to the general ledger.</span></span> <span data-ttu-id="b480d-125">In Project Operations, le righe delle note spese relative al progetto vengono registrate utilizzando regole di registrazione speciali:</span><span class="sxs-lookup"><span data-stu-id="b480d-125">In Project Operations, project-related expense report lines are posted using special posting rules:</span></span>

  - <span data-ttu-id="b480d-126">Il costo relativo al progetto (inclusa l'imposta non recuperabile) non viene registrato immediatamente nel conto dei costi di progetto della contabilità generale, ma viene invece registrato nel conto di integrazione delle spese.</span><span class="sxs-lookup"><span data-stu-id="b480d-126">Project-related cost (including non-recoverable tax) is not immediately posted to project cost account in general ledger, but instead is posted to expense integration account.</span></span> <span data-ttu-id="b480d-127">Questo conto è configurato in **Gestione progetti e contabilità** > **Configura** > **Parametri di gestione progetti e contabilità** , **Project Operations in Dynamics 365 Customer Engagement**.</span><span class="sxs-lookup"><span data-stu-id="b480d-127">This account is configured in **Project management and accounting** > **Setup** > **Project management and accounting parameters**, **Project Operations on Dynamics 365 Customer engagement** tab.</span></span>
  - <span data-ttu-id="b480d-128">La doppia scrittura si sincronizza con Dataverse utilizzando la mappa della tabella **Entità di esportazione delle spese di progetto di integrazione di Project Operations (msdyn\_expenses)** .</span><span class="sxs-lookup"><span data-stu-id="b480d-128">Dual-write synchronizes to Dataverse using **Project Operations integration project expenses export entity (msdyn\_expenses)** table map.</span></span>
  - <span data-ttu-id="b480d-129">Registro secondario delle imposte, registro secondario del fornitore e altre registrazioni finanziarie vengono registrati come applicabili quando viene registrata la nota spese.</span><span class="sxs-lookup"><span data-stu-id="b480d-129">Tax subledger, vendor subledger, and other financial postings are recorded as applicable at the time of expense report posting.</span></span>

  ![Integrazione di note spese](./media/DW6ExpenseReports.png)

<span data-ttu-id="b480d-131">Quando un record viene scritto nell'entità **Spese** in Dataverse, il sistema attiva il processo di approvazione automatizzato del record.</span><span class="sxs-lookup"><span data-stu-id="b480d-131">When a record is written to the **Expense** entity in Dataverse, the system triggers the automated approval process of the record.</span></span> <span data-ttu-id="b480d-132">Se necessario, lo stato del processo di approvazione automatizzato può essere rivisto in Dataverse andando in **Impostazioni avanzate** > **Sistema** > **Processi di sistema**.</span><span class="sxs-lookup"><span data-stu-id="b480d-132">If needed, the automated approval process status can be reviewed in Dataverse by going to **Advanced settings** > **System** > **System jobs**.</span></span> <span data-ttu-id="b480d-133">Dopo che l'approvazione è stata completata, vengono creati i record della classe di transazione materiale nell'entità **Valori effettivi**.</span><span class="sxs-lookup"><span data-stu-id="b480d-133">After approval is complete, expense transaction class records are created in the **Actuals** entity.</span></span>

<span data-ttu-id="b480d-134">I valori effettivi relativi alle spese vengono quindi elaborati utilizzando la mappa della tabella a doppia scrittura **Valori effettivi dell'integrazione di Project Operations (msdyn\_actuals)**.</span><span class="sxs-lookup"><span data-stu-id="b480d-134">Expense related actuals are then processed using the dual-write table map **Project Operations integration actuals (msdyn\_actuals)**.</span></span> <span data-ttu-id="b480d-135">Per ulteriori informazioni, vedi [Stime e valori effettivi di progetto](resource-dual-write-estimates-actuals.md).</span><span class="sxs-lookup"><span data-stu-id="b480d-135">For more information, see [Project estimates and actuals](resource-dual-write-estimates-actuals.md).</span></span>

<span data-ttu-id="b480d-136">Il processo periodico, **Importa da gestione temporanea** crea righe di giornale di registrazione di integrazione Project Operations correlate alla nota spesa.</span><span class="sxs-lookup"><span data-stu-id="b480d-136">The periodic process, **Import from staging** creates Expense report-related journal lines in the Project Operations Integration journal.</span></span> <span data-ttu-id="b480d-137">L'impostazione predefinita del conto di contropartita è il conto di integrazione della spesa.</span><span class="sxs-lookup"><span data-stu-id="b480d-137">The offset account defaults to the expense integration account.</span></span> <span data-ttu-id="b480d-138">La registrazione del giornale di registrazione di integrazione cancella il saldo del conto per la transazione di spesa e sposta l'importo della spesa nel conto dei costi di progetto.</span><span class="sxs-lookup"><span data-stu-id="b480d-138">The Posting integration journal clears the account balance for the expense transaction and moves the expense amount to the project cost account.</span></span> <span data-ttu-id="b480d-139">Il sistema inoltre crea le transazioni di contabilità secondaria del progetto per la fatturazione a valle e per il riconoscimento dei ricavi.</span><span class="sxs-lookup"><span data-stu-id="b480d-139">The system also creates project subledger transactions for downstream invoicing and revenue recognition purposes.</span></span>
