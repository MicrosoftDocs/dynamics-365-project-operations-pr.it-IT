---
title: Configurare la creazione automatica delle fatture
description: Questo argomento fornisce informazioni sull'impostazione e la configurazione della creazione automatica di fatture proforma.
author: rumant
manager: Annbe
ms.date: 04/05/2021
ms.topic: article
ms.service: project-operations
ms.reviewer: kfend
ms.author: rumant
ms.openlocfilehash: 359c5902e0b6a08ab7fc982095062e4d1816db6c
ms.sourcegitcommit: ca0fc078d1a12484eca193fe051b8442c0559db8
ms.translationtype: HT
ms.contentlocale: it-IT
ms.lasthandoff: 04/07/2021
ms.locfileid: "5866822"
---
# <a name="set-up-automatic-invoice-creation"></a><span data-ttu-id="b3336-103">Configurare la creazione automatica delle fatture</span><span class="sxs-lookup"><span data-stu-id="b3336-103">Set up automatic invoice creation</span></span> 
 
<span data-ttu-id="b3336-104">_**Si applica a:** Distribuzione semplice: dalla transazione alla fatturazione proforma, Project Operations per scenari basati su risorse/materiali non stoccati_</span><span class="sxs-lookup"><span data-stu-id="b3336-104">_**Applies To:** Lite deployment - deal to proforma invoicing, Project Operations for resource/non-stocked based scenarios_</span></span>

<span data-ttu-id="b3336-105">Puoi configurare la creazione automatica delle fatture in Dynamics 365 Project Operations.</span><span class="sxs-lookup"><span data-stu-id="b3336-105">You can configure automatic invoice creation in Dynamics 365 Project Operations.</span></span> <span data-ttu-id="b3336-106">Il sistema crea una bozza di fattura proforma basata sulla pianificazione delle fatture per ogni contratto di progetto e voce di contratto.</span><span class="sxs-lookup"><span data-stu-id="b3336-106">The system creates a draft proforma invoice based on the invoice schedule for each project contract and contract line.</span></span> <span data-ttu-id="b3336-107">Le pianificazioni delle fatture vengono configurate a livello di voce di contratto.</span><span class="sxs-lookup"><span data-stu-id="b3336-107">Invoice schedules are configured at the contract line level.</span></span> <span data-ttu-id="b3336-108">Ogni riga di un contratto può avere una pianificazione fattura distinta oppure la stessa pianificazione fattura può essere inclusa in ogni voce del contratto.</span><span class="sxs-lookup"><span data-stu-id="b3336-108">Each line on a contract can have a distinct invoice schedule, or the same invoice schedule can be included on every line of the contract.</span></span>

<span data-ttu-id="b3336-109">Quando crei una fattura, il sistema crea sempre almeno una fattura per contratto di progetto.</span><span class="sxs-lookup"><span data-stu-id="b3336-109">When you create an invoice, the system always creates at least one invoice per project contract.</span></span> <span data-ttu-id="b3336-110">In alcuni casi, potrebbero essere create più fatture.</span><span class="sxs-lookup"><span data-stu-id="b3336-110">In some cases, there may be multiple invoices created.</span></span> <span data-ttu-id="b3336-111">Ad esempio, se il contratto ha più clienti, verrà creato lo stesso numero di fatture del numero di clienti che hanno transazioni fatturabili da fatturare su quel contratto di progetto.</span><span class="sxs-lookup"><span data-stu-id="b3336-111">For example, if the contract has multiple customers, the same number of invoices will be created as the number of customers that have billable transactions to invoice on that project contract.</span></span>

## <a name="understand-how-transactions-are-included-on-an-invoice"></a><span data-ttu-id="b3336-112">Informazioni su come le transazioni sono incluse in una fattura</span><span class="sxs-lookup"><span data-stu-id="b3336-112">Understand how transactions are included on an invoice</span></span> 

<span data-ttu-id="b3336-113">A volte, ogni voce di contratto basata su progetto specifica una pianificazione fattura separata.</span><span class="sxs-lookup"><span data-stu-id="b3336-113">Sometimes, each project-based contract line specifies a separate invoice schedule.</span></span> <span data-ttu-id="b3336-114">Ad esempio, i servizi di implementazione per il contratto Adatum hanno le seguenti voci di contratto:</span><span class="sxs-lookup"><span data-stu-id="b3336-114">For example, implementation services for the Adatum contract have the following contract lines:</span></span>

- <span data-ttu-id="b3336-115">Il lavoro prototipo che è un prezzo fisso con due passaggi fondamentali creati manualmente.</span><span class="sxs-lookup"><span data-stu-id="b3336-115">Prototype work that is a fixed price with two manually created milestones.</span></span>
- <span data-ttu-id="b3336-116">Il lavoro di implementazione che include il tempo e verrà fatturato bisettimanalmente il lunedì.</span><span class="sxs-lookup"><span data-stu-id="b3336-116">Implementation work that includes Time and will be billed bi-weekly on Mondays.</span></span>
- <span data-ttu-id="b3336-117">Le spese sostenute che devono essere fatturate mensilmente il primo lunedì di ogni mese.</span><span class="sxs-lookup"><span data-stu-id="b3336-117">Expenses incurred that need to be billed monthly on the first Monday of each month.</span></span>

<span data-ttu-id="b3336-118">Le pianificazioni delle fatture definite su ciascuno di questi due articoli riga sono simili alla tabella seguente:</span><span class="sxs-lookup"><span data-stu-id="b3336-118">Invoice schedules defined on each of these two line items look like the following table:</span></span>

| <span data-ttu-id="b3336-119">Voce di contratto</span><span class="sxs-lookup"><span data-stu-id="b3336-119">Contract line</span></span> | <span data-ttu-id="b3336-120">Data esecuzione fattura</span><span class="sxs-lookup"><span data-stu-id="b3336-120">Invoice run date</span></span> | <span data-ttu-id="b3336-121">Data limite transazione</span><span class="sxs-lookup"><span data-stu-id="b3336-121">Transaction cut-off date</span></span> | <span data-ttu-id="b3336-122">Data passaggio fondamentale</span><span class="sxs-lookup"><span data-stu-id="b3336-122">Milestone date</span></span> | <span data-ttu-id="b3336-123">Importo passaggio fondamentale</span><span class="sxs-lookup"><span data-stu-id="b3336-123">Milestone amount</span></span> |
| --- | --- | --- | --- | --- |
| <span data-ttu-id="b3336-124">Lavoro prototipo</span><span class="sxs-lookup"><span data-stu-id="b3336-124">Prototype work</span></span> | <span data-ttu-id="b3336-125">Lunedì 5 ottobre</span><span class="sxs-lookup"><span data-stu-id="b3336-125">October 5, Monday</span></span> | - | <span data-ttu-id="b3336-126">Lunedì 5 ottobre</span><span class="sxs-lookup"><span data-stu-id="b3336-126">October 5, Monday</span></span> | <span data-ttu-id="b3336-127">5000 USD</span><span class="sxs-lookup"><span data-stu-id="b3336-127">5000 USD</span></span> |
| - | <span data-ttu-id="b3336-128">Martedì 3 novembre</span><span class="sxs-lookup"><span data-stu-id="b3336-128">November 3, Tuesday</span></span> | - | <span data-ttu-id="b3336-129">Martedì 3 novembre</span><span class="sxs-lookup"><span data-stu-id="b3336-129">November 3, Tuesday</span></span> | <span data-ttu-id="b3336-130">12,000 USD</span><span class="sxs-lookup"><span data-stu-id="b3336-130">12,000 USD</span></span> |
| <span data-ttu-id="b3336-131">Lavoro di implementazione</span><span class="sxs-lookup"><span data-stu-id="b3336-131">Implementation work</span></span> | <span data-ttu-id="b3336-132">Lunedì 5 ottobre</span><span class="sxs-lookup"><span data-stu-id="b3336-132">October 5, Monday</span></span> | <span data-ttu-id="b3336-133">Domenica 4 ottobre</span><span class="sxs-lookup"><span data-stu-id="b3336-133">October 4, Sunday</span></span> | - | - |
| - | <span data-ttu-id="b3336-134">Lunedì 19 ottobre</span><span class="sxs-lookup"><span data-stu-id="b3336-134">October 19, Monday</span></span> | <span data-ttu-id="b3336-135">Domenica 18 ottobre</span><span class="sxs-lookup"><span data-stu-id="b3336-135">October 18, Sunday</span></span> | - | - |
| - | <span data-ttu-id="b3336-136">Lunedì 2 novembre</span><span class="sxs-lookup"><span data-stu-id="b3336-136">November 2, Monday</span></span> | <span data-ttu-id="b3336-137">Domenica 1 novembre</span><span class="sxs-lookup"><span data-stu-id="b3336-137">November 1, Sunday</span></span> | - | - |
| - | <span data-ttu-id="b3336-138">Lunedì 16 novembre</span><span class="sxs-lookup"><span data-stu-id="b3336-138">November 16, Monday</span></span> | <span data-ttu-id="b3336-139">Domenica 15 novembre</span><span class="sxs-lookup"><span data-stu-id="b3336-139">November 15, Sunday</span></span> | - | - |
| <span data-ttu-id="b3336-140">Spese sostenute</span><span class="sxs-lookup"><span data-stu-id="b3336-140">Expenses incurred</span></span> | <span data-ttu-id="b3336-141">Lunedì 5 ottobre</span><span class="sxs-lookup"><span data-stu-id="b3336-141">October 5, Monday</span></span> | <span data-ttu-id="b3336-142">Domenica 4 ottobre</span><span class="sxs-lookup"><span data-stu-id="b3336-142">October 4, Sunday</span></span> | - | - |
| - | <span data-ttu-id="b3336-143">Lunedì 2 novembre</span><span class="sxs-lookup"><span data-stu-id="b3336-143">November 2, Monday</span></span> | <span data-ttu-id="b3336-144">Domenica 1 novembre</span><span class="sxs-lookup"><span data-stu-id="b3336-144">November 1, Sunday</span></span> | - | - |

<span data-ttu-id="b3336-145">In questo esempio, quando la fatturazione automatica viene eseguita il:</span><span class="sxs-lookup"><span data-stu-id="b3336-145">In this example when the automatic invoicing runs on:</span></span>

- <span data-ttu-id="b3336-146">**4 ottobre o prima**: nessuna fattura viene generata per questo contratto perché la tabella **Pianificazione fattura** per ciascuna di queste voci di contratto non chiama domenica 4 ottobre, come data di esecuzione della fattura.</span><span class="sxs-lookup"><span data-stu-id="b3336-146">**October 4 or any date before**: No invoice is generated for this contract because the **Invoice Schedule** table for each of these contract lines doesn't call out October 4, Sunday as an invoice run date.</span></span>
- <span data-ttu-id="b3336-147">**Lunedì 5 ottobre**: viene generata una fattura per:</span><span class="sxs-lookup"><span data-stu-id="b3336-147">**October 5 Monday**: One invoice is generated for:</span></span>

    - <span data-ttu-id="b3336-148">Il lavoro prototipo che include il passaggio fondamentale se è contrassegnato come **Pronto per la fatturazione**.</span><span class="sxs-lookup"><span data-stu-id="b3336-148">Prototype work that includes the milestone, if it is marked as **Ready to Invoice**.</span></span>
    - <span data-ttu-id="b3336-149">Il lavoro di implementazione che include tutte le transazioni temporali create prima della data limite della transazione di domenica 4 ottobre, contrassegnata come **Pronto per la fatturazione**.</span><span class="sxs-lookup"><span data-stu-id="b3336-149">Implementation work that includes all Time transactions created before the transaction cut-off date of October 4, Sunday, that is marked as **Ready to Invoice**.</span></span>
    - <span data-ttu-id="b3336-150">La spesa sostenuta che include tutte le transazioni di spesa create prima della data limite della transazione di domenica 4 ottobre, contrassegnata come **Pronto per la fatturazione**.</span><span class="sxs-lookup"><span data-stu-id="b3336-150">Expense incurred that includes all Expense transactions created before the transaction cut-off date of October 4, Sunday, that is marked as **Ready to Invoice**.</span></span>
  
- <span data-ttu-id="b3336-151">**Il 6 ottobre o prima del 19 ottobre**: nessuna fattura viene generata per questo contratto perché la tabella **Pianificazione fattura** per ciascuna di queste voci di contratto non chiama il 6 ottobre o una data prima del 19 ottobre, come data di esecuzione della fattura.</span><span class="sxs-lookup"><span data-stu-id="b3336-151">**On October 6 or any date before October 19**: No invoice is generated for this contract since the **Invoice Schedule** table for each of these contract lines does not call out October 6 or any date before October 19 as an invoice run date.</span></span>
- <span data-ttu-id="b3336-152">**Lunedì 19 ottobre**: una fattura viene generata per il lavoro di implementazione che include tutte le transazioni temporali create prima della data limite della transazione di domenica 18 ottobre, contrassegnata come **Pronto per la fatturazione**.</span><span class="sxs-lookup"><span data-stu-id="b3336-152">**October 19, Monday**: One invoice is generated for implementation work that includes all Time transactions created before the transaction cut-off date of October 18, Sunday, that is marked as **Ready to Invoice**.</span></span>
- <span data-ttu-id="b3336-153">**Lunedì 2 novembre**: viene generata una fattura per:</span><span class="sxs-lookup"><span data-stu-id="b3336-153">**November 2 Monday**: One invoice is generated for:</span></span>

    - <span data-ttu-id="b3336-154">Il lavoro di implementazione che include tutte le transazioni temporali create prima della data limite della transazione di domenica 1 novembre, contrassegnata come **Pronto per la fatturazione**.</span><span class="sxs-lookup"><span data-stu-id="b3336-154">Implementation work that includes all Time transactions created before the transaction cut-off date of November 1, Sunday, that is marked as **Ready to Invoice**.</span></span>
    - <span data-ttu-id="b3336-155">La spesa sostenuta che include tutte le transazioni di spesa create prima della data limite della transazione di domenica 1 novembre, contrassegnata come **Pronto per la fatturazione**.</span><span class="sxs-lookup"><span data-stu-id="b3336-155">Expense incurred that includes all Expense transactions created before the transaction cut-off date of November 1, Sunday, that is marked as **Ready to Invoice**.</span></span>

- <span data-ttu-id="b3336-156">**Martedì 3 novembre**: viene generata una fattura per il lavoro prototipo che include il passaggio fondamentale per 12000 USD, se contrassegnata come **Pronto per la fatturazione**.</span><span class="sxs-lookup"><span data-stu-id="b3336-156">**November 3, Tuesday**: One invoice is generated for prototype work that includes the milestone for 12000 USD, if it is marked as **Ready to Invoice**.</span></span>

## <a name="configure-automatic-invoicing"></a><span data-ttu-id="b3336-157">Configurare la fatturazione automatica</span><span class="sxs-lookup"><span data-stu-id="b3336-157">Configure automatic invoicing</span></span>

<span data-ttu-id="b3336-158">Completa questa procedura per configurare un'esecuzione di fatturazione automatizzata.</span><span class="sxs-lookup"><span data-stu-id="b3336-158">Complete the following steps to configure an automated invoice run.</span></span>

1. <span data-ttu-id="b3336-159">In **Project Operations**, vai a **Impostazioni** > **Impostazione fattura ricorrente**.</span><span class="sxs-lookup"><span data-stu-id="b3336-159">In **Project Operations**, go to **Settings** > **Recurring Invoice Setup**.</span></span>
2. <span data-ttu-id="b3336-160">Crea un processo batch e denominalo **Project Operations - Creazione di fatture**.</span><span class="sxs-lookup"><span data-stu-id="b3336-160">Create a batch job, and name it **rPoject Operations Create Invoices**.</span></span> <span data-ttu-id="b3336-161">Il nome del processo batch deve includere le parole "creazione di fatture".</span><span class="sxs-lookup"><span data-stu-id="b3336-161">The name of the batch job must include the words, "create invoices".</span></span>
3. <span data-ttu-id="b3336-162">Nel campo **Tipo di processo** seleziona **Nome**.</span><span class="sxs-lookup"><span data-stu-id="b3336-162">In the **Job Type** field, select **None**.</span></span> <span data-ttu-id="b3336-163">Per impostazione predefinita, i campi **Frequenza giornaliera** e **Attivo** sono impostate su **Sì**.</span><span class="sxs-lookup"><span data-stu-id="b3336-163">By default, the **Frequency Daily** and **Is Active** fields are set to **Yes**.</span></span>
4. <span data-ttu-id="b3336-164">Seleziona **Esegui flusso di lavoro**.</span><span class="sxs-lookup"><span data-stu-id="b3336-164">Select **Run Workflow**.</span></span> <span data-ttu-id="b3336-165">Nella finestra di dialogo **Cerca record**, vengono visualizzati tre flussi di lavoro:</span><span class="sxs-lookup"><span data-stu-id="b3336-165">In the **Look Up Record** dialog box, you will see three workflows:</span></span>

- <span data-ttu-id="b3336-166">ProcessRunCaller</span><span class="sxs-lookup"><span data-stu-id="b3336-166">ProcessRunCaller</span></span>
- <span data-ttu-id="b3336-167">ProcessRunner</span><span class="sxs-lookup"><span data-stu-id="b3336-167">ProcessRunner</span></span>
- <span data-ttu-id="b3336-168">UpdateRoleUtilization</span><span class="sxs-lookup"><span data-stu-id="b3336-168">UpdateRoleUtilization</span></span>

5. <span data-ttu-id="b3336-169">Seleziona **ProcessRunCaller** e quindi **Aggiungi**.</span><span class="sxs-lookup"><span data-stu-id="b3336-169">Select **ProcessRunCaller**, and then select **Add**.</span></span>
6. <span data-ttu-id="b3336-170">Nella finestra di dialogo successiva, seleziona **OK**.</span><span class="sxs-lookup"><span data-stu-id="b3336-170">In the next dialog box, select **OK**.</span></span> <span data-ttu-id="b3336-171">Un flusso di lavoro **Sospendi** è seguito da un flusso di lavoro **Elabora**.</span><span class="sxs-lookup"><span data-stu-id="b3336-171">A **Sleep** workflow is followed by a **Process** workflow.</span></span> 

> [!NOTE]
> <span data-ttu-id="b3336-172">Puoi anche selezionare **ProcessRunner** nel passaggio 5.</span><span class="sxs-lookup"><span data-stu-id="b3336-172">You can also select **ProcessRunner** in step 5.</span></span> <span data-ttu-id="b3336-173">Successivamente, quando selezioni **OK**, un flusso di lavoro **Elabora** è seguito da un flusso di lavoro **Sospendi**.</span><span class="sxs-lookup"><span data-stu-id="b3336-173">Then, when you select **OK**, a **Process** workflow is followed by a **Sleep** workflow.</span></span>

<span data-ttu-id="b3336-174">I flussi di lavoro **ProcessRunCaller** e **ProcessRunner** creano le fatture.</span><span class="sxs-lookup"><span data-stu-id="b3336-174">The **ProcessRunCaller** and **ProcessRunner** workflows create invoices.</span></span> <span data-ttu-id="b3336-175">**ProcessRunCaller** chiama **ProcessRunner**.</span><span class="sxs-lookup"><span data-stu-id="b3336-175">**ProcessRunCaller** calls **ProcessRunner**.</span></span> <span data-ttu-id="b3336-176">**ProcessRunner** è il flusso di lavoro che crea le fatture.</span><span class="sxs-lookup"><span data-stu-id="b3336-176">**ProcessRunner** is the workflow that actually creates the invoices.</span></span> <span data-ttu-id="b3336-177">Il flusso di lavoro esamina tutte le voci di contratto per le quali devono essere create le fatture e crea le fatture per tali voci.</span><span class="sxs-lookup"><span data-stu-id="b3336-177">The workflow goes through all the contract lines that invoices must be created for, and creates invoices for those lines.</span></span> <span data-ttu-id="b3336-178">Per determinare le voci di contratto per le quali creare le fatture, il processo analizza le date di esecuzione delle fatture per le voci di contratto.</span><span class="sxs-lookup"><span data-stu-id="b3336-178">To determine the contract lines that invoices must be created for, the job looks at invoice run dates for the contract lines.</span></span> <span data-ttu-id="b3336-179">Se le voci di contratto appartenenti a un contratto hanno la stessa data di esecuzione delle fatture, le transazioni sono combinate in una fattura con due righe fattura.</span><span class="sxs-lookup"><span data-stu-id="b3336-179">If contract lines that belong to one contract have the same invoice run date, the transactions are combined into one invoice that has two invoice lines.</span></span> <span data-ttu-id="b3336-180">Se non sono presenti transazioni per le quali creare fatture, il processo ignora la creazione di una fattura.</span><span class="sxs-lookup"><span data-stu-id="b3336-180">If there are no transactions to create invoices for, the job skips creating an invoice.</span></span>

<span data-ttu-id="b3336-181">Dopo il termine dell'esecuzione di **ProcessRunner**, questo flusso di lavoro chiama **ProcessRunCaller**, fornisce l'ora di fine e viene chiuso.</span><span class="sxs-lookup"><span data-stu-id="b3336-181">After **ProcessRunner** has finished running, it calls **ProcessRunCaller**, provides the end time, and is closed.</span></span> <span data-ttu-id="b3336-182">**ProcessRunCaller** avvia quindi un timer che viene eseguito per 24 ore a partire dall'ora di fine specificata.</span><span class="sxs-lookup"><span data-stu-id="b3336-182">**ProcessRunCaller** then starts a timer that runs for 24-hours from the specified end time.</span></span> <span data-ttu-id="b3336-183">Alla fine dell'esecuzione del timer, **ProcessRunCaller** viene chiuso.</span><span class="sxs-lookup"><span data-stu-id="b3336-183">At the end of the timer, **ProcessRunCaller** is closed.</span></span>

<span data-ttu-id="b3336-184">Il processo batch per la creazione di fatture è un processo ricorrente.</span><span class="sxs-lookup"><span data-stu-id="b3336-184">The batch process job for creating invoices is a recurrent job.</span></span> <span data-ttu-id="b3336-185">Se questo processo batch viene eseguito molte volte, vengono create molteplici istanze del processo che causa gli errori.</span><span class="sxs-lookup"><span data-stu-id="b3336-185">If this batch process is run many times, multiple instances of the job are created and causes errors.</span></span> <span data-ttu-id="b3336-186">Pertanto, devi avviare il processo batch una sola volta e riavviarlo solo se viene interrotto.</span><span class="sxs-lookup"><span data-stu-id="b3336-186">Therefore, you should start the batch process only one time, and then restart only if it stops running.</span></span>

> [!NOTE]
> <span data-ttu-id="b3336-187">La fatturazione in batch in Project Operations viene eseguita solo per le voci di contratto di progetto configurate dalle pianificazioni fatturazione.</span><span class="sxs-lookup"><span data-stu-id="b3336-187">Batch invoicing in Project Operations only runs for project contract lines that are configured by invoice schedules.</span></span> <span data-ttu-id="b3336-188">Una riga di contratto con un metodo di fatturazione a prezzo fisso deve avere i passaggi fondamentali configurati.</span><span class="sxs-lookup"><span data-stu-id="b3336-188">A contract line with a fixed price billing method must have milestones configured.</span></span> <span data-ttu-id="b3336-189">Una riga di contratto di progetto con un metodo di fatturazione di tempo e materiali richiederà una pianificazione fatturazione basata sulla data.</span><span class="sxs-lookup"><span data-stu-id="b3336-189">A project contract line with a time and material billing method will need a date-based invoice schedule set up.</span></span>


[!INCLUDE[footer-include](../../includes/footer-banner.md)]
